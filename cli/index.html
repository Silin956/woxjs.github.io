<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>脚手架工具 | WoX</title>
    <meta name="description" content="A dynamic loader MVC architecture based on Vue.js development which use web virtual service and web virtual request mode.">
    
    
    <link rel="preload" href="/assets/css/0.styles.9ede7954.css" as="style"><link rel="preload" href="/assets/js/app.bf16abc9.js" as="script"><link rel="preload" href="/assets/js/8.4cae5880.js" as="script"><link rel="prefetch" href="/assets/js/10.ce8fbcca.js"><link rel="prefetch" href="/assets/js/11.8acb355b.js"><link rel="prefetch" href="/assets/js/12.4eca615b.js"><link rel="prefetch" href="/assets/js/13.ff73f045.js"><link rel="prefetch" href="/assets/js/14.e15a24a3.js"><link rel="prefetch" href="/assets/js/15.760e39af.js"><link rel="prefetch" href="/assets/js/2.5ed48305.js"><link rel="prefetch" href="/assets/js/3.d6f7a4c8.js"><link rel="prefetch" href="/assets/js/4.c0e03a07.js"><link rel="prefetch" href="/assets/js/5.207e9a59.js"><link rel="prefetch" href="/assets/js/6.ff8ba342.js"><link rel="prefetch" href="/assets/js/7.9308bdd8.js"><link rel="prefetch" href="/assets/js/9.3e22567b.js">
    <link rel="stylesheet" href="/assets/css/0.styles.9ede7954.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">WoX</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">简介</a></div><div class="nav-item"><a href="/guide/" class="nav-link">指南</a></div><div class="nav-item"><a href="/api/" class="nav-link">API</a></div><div class="nav-item"><a href="/cli/" class="nav-link router-link-exact-active router-link-active">脚手架</a></div><div class="nav-item"><a href="/plugins/" class="nav-link">核心插件</a></div> <a href="https://github.com/woxjs/wox" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">简介</a></div><div class="nav-item"><a href="/guide/" class="nav-link">指南</a></div><div class="nav-item"><a href="/api/" class="nav-link">API</a></div><div class="nav-item"><a href="/cli/" class="nav-link router-link-exact-active router-link-active">脚手架</a></div><div class="nav-item"><a href="/plugins/" class="nav-link">核心插件</a></div> <a href="https://github.com/woxjs/wox" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><a href="/cli/" class="active sidebar-link">脚手架工具</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/cli/#evio-cli" class="sidebar-link">@evio/cli</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/cli/#install" class="sidebar-link">install</a></li><li class="sidebar-sub-header"><a href="/cli/#uninstall" class="sidebar-link">uninstall</a></li><li class="sidebar-sub-header"><a href="/cli/#update" class="sidebar-link">update</a></li><li class="sidebar-sub-header"><a href="/cli/#view" class="sidebar-link">view</a></li><li class="sidebar-sub-header"><a href="/cli/#自定义插件" class="sidebar-link">自定义插件</a></li><li class="sidebar-sub-header"><a href="/cli/#make-plugin" class="sidebar-link">Make Plugin</a></li><li class="sidebar-sub-header"><a href="/cli/#dev-link" class="sidebar-link">Dev link</a></li><li class="sidebar-sub-header"><a href="/cli/#dev-unlink" class="sidebar-link">Dev unlink</a></li></ul></li><li class="sidebar-sub-header"><a href="/cli/#wox-cli" class="sidebar-link">@wox/cli</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/cli/#wox-new" class="sidebar-link">wox:new</a></li><li class="sidebar-sub-header"><a href="/cli/#wox" class="sidebar-link">wox</a></li><li class="sidebar-sub-header"><a href="/cli/#对wox进行插件的工具扩展" class="sidebar-link">对wox进行插件的工具扩展</a></li></ul></li></ul></li></ul> </div> <div class="page"> <div class="content"><h1 id="脚手架工具"><a href="#脚手架工具" aria-hidden="true" class="header-anchor">#</a> 脚手架工具</h1> <p>它是一个基于 Vue.js 进行快速开发的完整系统，提供：</p> <ul><li>通过 <code>@vue/cli</code> 搭建交互式的项目脚手架。</li> <li>通过 <code>@vue/cli</code> + <code>@vue/cli-service-global</code> 快速开始零配置原型开发。</li> <li>一个运行时依赖 (<code>@vue/cli-service</code>)，该依赖：</li> <li>可升级；</li> <li>基于 webpack 构建，并带有合理的默认配置；</li> <li>可以通过项目内的配置文件进行配置；</li> <li>可以通过插件进行扩展。</li> <li>一个丰富的官方插件集合，集成了前端生态中最好的工具。</li> <li>一套完全图形化的创建和管理 Vue.js 项目的用户界面。</li></ul> <p>Vue CLI 致力于将 Vue 生态中的工具基础标准化。它确保了各种构建工具能够基于智能的默认配置即可平稳衔接，这样你可以专注在撰写应用上，而不必花好几天去纠结配置的问题。与此同时，它也为每个工具提供了调整配置的灵活性，无需 eject。</p> <p>我们需要安装2个工具</p> <ul><li><code>@evio/cli</code> 插件工厂</li> <li><code>@wox/cli</code> wox的专属脚手架</li> <li><a href="https://cli.vuejs.org/zh" target="_blank" rel="noopener noreferrer"><code>@vue/cli</code><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> vue官方脚手架</li></ul> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>$ <span class="token function">npm</span> i @evio/cli -g
$ cli <span class="token function">install</span> @wox/cli
$ <span class="token function">npm</span> <span class="token function">install</span> -g @vue/cli
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h2 id="evio-cli"><a href="#evio-cli" aria-hidden="true" class="header-anchor">#</a> @evio/cli</h2> <p>它是一个插件工厂，只负责管理插件。它有如下的功能。</p> <h3 id="install"><a href="#install" aria-hidden="true" class="header-anchor">#</a> install</h3> <p>格式：<code>cli install &lt;module...&gt; [-r &lt;registry&gt;]</code></p> <p>安装一个插件模块，并且使用源。</p> <ul><li><strong>module</strong> 插件模块，比如<code>@wox/cli</code></li> <li><strong>registry</strong> 安装源，比如<code>cpm|cnpm</code>，甚至可以使用地址<code>http://127.0.0.1:8080</code></li></ul> <h3 id="uninstall"><a href="#uninstall" aria-hidden="true" class="header-anchor">#</a> uninstall</h3> <p>格式：<code>cli uninstall &lt;module...&gt;</code></p> <p>卸载一个插件</p> <ul><li><strong>module</strong> 插件模块，比如<code>@wox/cli</code></li></ul> <h3 id="update"><a href="#update" aria-hidden="true" class="header-anchor">#</a> update</h3> <p>格式：<code>cli update [module...] [-r &lt;registry&gt;]</code></p> <p>当没有module的时候，表现为更新<code>@evio/cli</code>。当有module的时候，表现为更新这些插件。</p> <ul><li><strong>module</strong> 插件模块，比如<code>@wox/cli</code></li> <li><strong>registry</strong> 安装源，比如<code>cpm|cnpm</code>，甚至可以使用地址<code>http://127.0.0.1:8080</code></li></ul> <h3 id="view"><a href="#view" aria-hidden="true" class="header-anchor">#</a> view</h3> <p>格式：<code>cli view [module...]</code></p> <p>查看插件详情。</p> <p>当没有module的时候，显示已安装插件的详情；有module的时候，表示插件这些插件的详情。</p> <ul><li><strong>module</strong> 插件模块，比如<code>@wox/cli</code></li></ul> <h3 id="自定义插件"><a href="#自定义插件" aria-hidden="true" class="header-anchor">#</a> 自定义插件</h3> <p>如何自定义插件，其实很简单，它不需要在<code>package.json</code>中写入<code>bin</code>属性。只要插件的调用出口到处一个函数即可。它是基于<a href="https://www.npmjs.com/package/commander" target="_blank" rel="noopener noreferrer">commander<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>实现的。</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>module<span class="token punctuation">.</span><span class="token function-variable function">exports</span> <span class="token operator">=</span> <span class="token punctuation">(</span>program<span class="token punctuation">,</span> client<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  program<span class="token punctuation">.</span><span class="token function">command</span><span class="token punctuation">(</span><span class="token operator">...</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">option</span><span class="token punctuation">(</span><span class="token operator">...</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">action</span><span class="token punctuation">(</span>client<span class="token punctuation">.</span><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./lib/xxx'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
module<span class="token punctuation">.</span>exports<span class="token punctuation">.</span>__IS_CLI_PLUGIN__ <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><blockquote><p>注意：<code>module.exports.__IS_CLI_PLUGIN__ = true;</code>为必须，表明是一个cli插件。</p></blockquote> <p>具体内部逻辑如何定义看插件需求了。</p> <p><code>client</code>对象一般只有一个方法需要使用<code>client.require(path)</code>，动态调用一个文件模块。初始化它需要这样写。</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">new</span> <span class="token class-name">client<span class="token punctuation">.</span>constructor</span><span class="token punctuation">(</span>pather<span class="token punctuation">,</span> client<span class="token punctuation">.</span>util<span class="token punctuation">,</span> client<span class="token punctuation">.</span>pkg<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ul><li><strong>pather</strong> <code>string</code> 表示插件所在的根目录。</li></ul> <h3 id="make-plugin"><a href="#make-plugin" aria-hidden="true" class="header-anchor">#</a> Make Plugin</h3> <p>创建新的插件模板</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>cli <span class="token function">make</span> <span class="token punctuation">[</span>plugin<span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="dev-link"><a href="#dev-link" aria-hidden="true" class="header-anchor">#</a> Dev link</h3> <p>开发模式下通过模板创建后需要link到<code>@evio/cli</code>上，所以我们需要使用以下命令</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>cli <span class="token function">link</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><blockquote><p>注意：你必须进入到插件文件夹下</p></blockquote> <h3 id="dev-unlink"><a href="#dev-unlink" aria-hidden="true" class="header-anchor">#</a> Dev unlink</h3> <p>通过link软链的插件，需要解除软链，那么我们需要使用以下命令</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>cli unlink
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><blockquote><p>注意：你必须进入到插件文件夹下</p></blockquote> <h2 id="wox-cli"><a href="#wox-cli" aria-hidden="true" class="header-anchor">#</a> @wox/cli</h2> <p>它是wox架构的支持工具。</p> <h3 id="wox-new"><a href="#wox-new" aria-hidden="true" class="header-anchor">#</a> wox:new</h3> <p>格式：<code>cli wox:new [project] [-p]</code></p> <p>创建一个新的项目或插件。</p> <ul><li><strong>project</strong> 项目名称。不写的话，系统将提示你写入。</li> <li><strong>-p</strong> 表示生成一个插件项目。</li></ul> <p>创建主项目</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>cli wox:new
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>创建插件</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>cli wox:new -p
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="wox"><a href="#wox" aria-hidden="true" class="header-anchor">#</a> wox</h3> <p>创建开发辅助文件。我们来看下列表（通过<code>cli wox -h</code>查看）：</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>Usage: wox <span class="token punctuation">[</span>options<span class="token punctuation">]</span> <span class="token operator">&lt;</span>path<span class="token operator">&gt;</span>

create a new wox <span class="token function">file</span> by <span class="token function">type</span>

Options:
  -p, --component <span class="token punctuation">[</span>type<span class="token punctuation">]</span>   create a new <span class="token variable"><span class="token variable">`</span>Vue.component<span class="token variable">`</span></span> <span class="token function">file</span> <span class="token punctuation">(</span>default: null<span class="token punctuation">)</span>
  -d, --directive          create a new <span class="token variable"><span class="token variable">`</span>Vue.directive<span class="token variable">`</span></span> <span class="token function">file</span>
  -f, --filter             create a new <span class="token variable"><span class="token variable">`</span>Vue.filter<span class="token variable">`</span></span> <span class="token function">file</span>
  -x, --mixin              create a new <span class="token variable"><span class="token variable">`</span>Vue.mixin<span class="token variable">`</span></span> <span class="token function">file</span>
  -c, --controller <span class="token punctuation">[</span>type<span class="token punctuation">]</span>  create a new <span class="token variable"><span class="token variable">`</span>Controller<span class="token variable">`</span></span> <span class="token function">file</span> <span class="token punctuation">(</span>default: null<span class="token punctuation">)</span>
  -m, --middleware         create a new <span class="token variable"><span class="token variable">`</span>Middleware<span class="token variable">`</span></span> <span class="token function">file</span>
  -s, --service <span class="token punctuation">[</span>type<span class="token punctuation">]</span>     create a new <span class="token variable"><span class="token variable">`</span>Service<span class="token variable">`</span></span> <span class="token function">file</span> <span class="token punctuation">(</span>default: null<span class="token punctuation">)</span>
  -t, --decorate           create a new <span class="token variable"><span class="token variable">`</span>Decorate<span class="token variable">`</span></span> <span class="token function">file</span>
  -w, --webview            create a new <span class="token variable"><span class="token variable">`</span>Webview<span class="token variable">`</span></span> <span class="token function">file</span>
  -h, --help               output usage information
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><p>通过<code>-</code>符号来区分创建的类型文件。</p> <blockquote><p>注意：
<code>component</code>比较特殊，它有4种格式<code>-p</code> <code>-p vue</code> <code>-p js</code> <code>-p jsx</code>，每个不同类型将创建不同的文件结尾。
<code>controller</code>比较特殊，它有3种格式<code>-c</code> <code>-c js</code> <code>-c jsx</code>，每个不同类型将创建不同的文件结尾。
<code>service</code>比较特殊，它有3种格式<code>-s</code> <code>-s js</code> <code>-s jsx</code>，每个不同类型将创建不同的文件结尾。</p></blockquote> <h3 id="对wox进行插件的工具扩展"><a href="#对wox进行插件的工具扩展" aria-hidden="true" class="header-anchor">#</a> 对wox进行插件的工具扩展</h3> <p>我们需要在插件的根目录下存放一个<code>commander.js</code>来编写。</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>module<span class="token punctuation">.</span><span class="token function-variable function">exports</span> <span class="token operator">=</span> <span class="token punctuation">(</span>program<span class="token punctuation">,</span> client<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  program
    <span class="token punctuation">.</span><span class="token function">command</span><span class="token punctuation">(</span><span class="token string">'wox:store &lt;file&gt;'</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">description</span><span class="token punctuation">(</span><span class="token string">'add a new store file for vuex'</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">action</span><span class="token punctuation">(</span>client<span class="token punctuation">.</span><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./addfile.js'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
module<span class="token punctuation">.</span>exports<span class="token punctuation">.</span>__IS_CLI_PLUGIN__ <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>比如上面的代码，我们创建来一个新的<code>wox:store</code>命令。当这个命令被调用的时候，我们会进入<code>addfile.js</code>。</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// ./addfile.js</span>
<span class="token keyword">const</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'fs'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> ejs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'ejs'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> fse <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'fs-extra'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> file<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> template <span class="token operator">=</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'.template.ejs'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> output <span class="token operator">=</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>process<span class="token punctuation">.</span><span class="token function">cwd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'app/vue/storage'</span><span class="token punctuation">,</span> file <span class="token operator">+</span> <span class="token string">'.js'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> result <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">render</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> template<span class="token punctuation">,</span> output<span class="token punctuation">,</span> <span class="token punctuation">{</span>
    name<span class="token punctuation">:</span> <span class="token function">prefix</span><span class="token punctuation">(</span><span class="token operator">...</span>file<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>result<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'create file success:'</span><span class="token punctuation">,</span> output<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">'create file failed.'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">render</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> template<span class="token punctuation">,</span> output<span class="token punctuation">,</span> data <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>fs<span class="token punctuation">.</span><span class="token function">existsSync</span><span class="token punctuation">(</span>template<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">'can not find template:'</span> <span class="token operator">+</span> template<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> code <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span>resolve<span class="token punctuation">,</span> reject<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    ejs<span class="token punctuation">.</span><span class="token function">renderFile</span><span class="token punctuation">(</span>template<span class="token punctuation">,</span> data<span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>err<span class="token punctuation">,</span> str<span class="token punctuation">)</span><span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token function">reject</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">resolve</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>fs<span class="token punctuation">.</span><span class="token function">existsSync</span><span class="token punctuation">(</span>output<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    fse<span class="token punctuation">.</span><span class="token function">outputFileSync</span><span class="token punctuation">(</span>output<span class="token punctuation">,</span> code<span class="token punctuation">,</span> <span class="token string">'utf8'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    ctx<span class="token punctuation">.</span><span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> fs<span class="token punctuation">.</span><span class="token function">unlinkSync</span><span class="token punctuation">(</span>output<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">prefix</span><span class="token punctuation">(</span><span class="token operator">...</span>names<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> name <span class="token operator">=</span> names<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">'_'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex">/\//g</span><span class="token punctuation">,</span> <span class="token string">'_'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex">/[_-][a-z0-9]/ig</span><span class="token punctuation">,</span> s <span class="token operator">=&gt;</span> s<span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toUpperCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">let</span> first <span class="token operator">=</span> name<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> next <span class="token operator">=</span> name<span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> first<span class="token punctuation">.</span><span class="token function">toUpperCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> next<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br></div></div><p>这样，执行命令的时候，我们会创建一个<code>app/vue/storage</code>下的文件，提高开发速度。</p> <blockquote><p>注意：我们约定，所有插件的开发，都必须在主项目下，最好新建<code>plugins</code>文件夹，然后安装在下面。</p></blockquote></div> <div class="page-edit"><div class="edit-link"><a href="https://github.com/woxjs/wox/edit/master/docs/cli/README.md" target="_blank" rel="noopener noreferrer">帮助我们改善此页面！</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <!----></div> <!----> </div> <!----></div></div>
    <script src="/assets/js/app.bf16abc9.js" defer></script><script src="/assets/js/8.4cae5880.js" defer></script>
  </body>
</html>
